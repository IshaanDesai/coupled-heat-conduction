<?xml version="1.0"?>

<precice-configuration>

    <log>
	<sink type="stream" output="stdout" filter="%Severity% > debug" enabled="true"/>
    </log>
  
  <solver-interface dimensions="2">
    
    <data:scalar name="k_00" />
    <data:scalar name="k_01" />
    <data:scalar name="k_10" />
    <data:scalar name="k_11" />
    <data:scalar name="porosity" />

    <mesh name="macro-mesh">
       <use-data name="k_00" />
       <use-data name="k_01" />
       <use-data name="k_10" />
       <use-data name="k_11" />
       <use-data name="porosity"/>
    </mesh>

    <mesh name="micro-sims">
       <use-data name="k_00" />
       <use-data name="k_01" />
       <use-data name="k_10" />
       <use-data name="k_11" />
       <use-data name="porosity"/>
    </mesh>

    <participant name="Macro-heat">
      <use-mesh name="macro-mesh" provide="yes"/>
      <use-mesh name="micro-sims" from="Micro-manager"/>
      <read-data name="k_00" mesh="macro-mesh"/>
      <read-data name="k_01" mesh="macro-mesh"/>
      <read-data name="k_10" mesh="macro-mesh"/>
      <read-data name="k_11" mesh="macro-mesh"/>
      <read-data name="porosity" mesh="macro-mesh"/>
      <mapping:nearest-neighbor direction="read" from="micro-sims" to="macro-mesh" constraint="consistent"/>
    </participant>
    
    <participant name="Micro-manager">		
      <use-mesh name="micro-sims" provide="yes"/>
      <use-mesh name="macro-mesh" from="Macro-heat"/>
      <write-data name="k_00" mesh="micro-sims"/>
      <write-data name="k_01" mesh="micro-sims"/>
      <write-data name="k_10" mesh="micro-sims"/>
      <write-data name="k_11" mesh="micro-sims"/>
      <write-data name="porosity" mesh="micro-sims"/>
    </participant>

    <m2n:sockets from="Micro-manager" to="Macro-heat"/>

    <coupling-scheme:serial-explicit>
       <participants first="Micro-manager" second="Macro-heat"/>
       <max-time value="0.2"/>
       <time-window-size value="1.0e-3"/>
       <exchange data="k_00" mesh="micro-sims" from="Micro-manager" to="Macro-heat"/>
       <exchange data="k_01" mesh="micro-sims" from="Micro-manager" to="Macro-heat"/>
       <exchange data="k_10" mesh="micro-sims" from="Micro-manager" to="Macro-heat"/>
       <exchange data="k_11" mesh="micro-sims" from="Micro-manager" to="Macro-heat"/>
       <exchange data="porosity" mesh="micro-sims" from="Micro-manager" to="Macro-heat"/>
    </coupling-scheme:serial-explicit>

  </solver-interface>
</precice-configuration>
